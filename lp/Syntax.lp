require open Logic.U.Arrow;

symbol ğ’® : TYPE;
builtin "String" â‰” ğ’®;

symbol List : TYPE;

constant symbol Bool : Set;
constant symbol true : El Bool;
constant symbol and : El (Bool â¤³ Bool â¤³ Bool);

injective symbol list : Set â†’ Set;
injective symbol â‹… [a] : El (list a);
injective symbol â¨¾ [a] : El (a â¤³ list a â¤³ list a);
notation â¨¾ infix right 10;

symbol map [a b] : El ((a â¤³ b) â¤³ list a â¤³ list b);
rule (map $f (â‹…)) â†ª (â‹…)
with (map $f ($x â¨¾ $xs)) â†ª ($f $x) â¨¾ (map $f $xs);

symbol eo : Set;
symbol EO : TYPE â‰” El eo;

injective symbol sym : ğ’® â†’ El (eo);
injective symbol app : ğ’® â†’ El (list eo â¤³ eo);

sequential symbol ty : ğ’® â†’ TYPE;
// rw. rules defined throughout translation. e.g.,
rule (ty "Bool") â†ª Set
with (ty "and") â†ª El (Bool â¤³ Bool â¤³ Bool);

sequential symbol tm (str : ğ’®) : ty str;
// rw. rules defined throughout translation. e.g.,
rule (tm "Bool") â†ª Bool;
rule (tm "and")  â†ª and;


symbol foldl [a b] :
  El ((b â¤³ a â¤³ b) â¤³ b â¤³ list a â¤³ b);
rule (foldl $f $acc (â‹…)) â†ª $acc
with (foldl $f $acc ($x â¨¾ $xs)) â†ª foldl $f ($f $acc $x) $xs;


symbol __ : EO â†’ EO â†’ EO;
rule (__ $e $e') â†ª (app "_" ($e â¨¾ $e' â¨¾ â‹…));

symbol foo : EO â‰”
  foldl (Î» acc e, __ acc e)
    (sym "and") (sym "true" â¨¾ sym "true" â¨¾ â‹…);

symbol typ : EO â†’ EO;
symbol ev [a] : EO â†’ El a;
